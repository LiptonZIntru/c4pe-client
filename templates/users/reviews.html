{% extends 'layouts/layout.html' %}

{% block css %}
    {% load static %}
    <style>
        @media only screen and (max-width: 575px)
        {
            #description{
                font-size: smaller;
            }
        }

        @media only screen and (min-width: 576px)
        {
            #country{
                width: 14rem;
            }
        }

        @media only screen and (min-width: 992px)
        {
            #country{
                width: 11rem;
            }
            #zip{
                width: 13rem;
            }
            #city{
                width: 13rem;
            }
        }
    </style>
{% endblock %}

{% block title %}
{{ user.username }}
{% endblock %}

{% block content %}
    <div class="container mt-3 mb-3">
        <div class="card">
            <div class="card-body row">
                <div class="col-sm-3">
                    {% if user.avatar != NULL and user.avatar != "" and user.avatar != "None" %}
                        <img src="{{ user.avatar }}"/>
                    {% else %}
                        <img src="{% static '/img/AvatarPlaceholder.svg' %}" style="width: available; max-width: 250px;"/>
                    {% endif %}
                </div>

                <div class="col-sm-9 pt-2">
                    <div class="row container">
                        <h3 class="font-weight-bold">
                              {% if user.isVerified == 1 %}
                                  <i class="fas fa-check-circle" style="color:green" data-toggle="tooltip" data-placement="bottom" title="Verified user"></i>
                              {% endif %}
                              {% if user.id != NULL %}
                                {{ user.username }}
                              {% else %}
                                User not found!
                              {% endif %}
                        </h3>
                        {% if user.country != NULL and user.country != "" %}
                        <p class="text-muted pl-2" style="padding-top: 0.5rem !important;">({{ user.country }})</p>
                        {% endif %}
                    </div>
                    {% if user.description != NULL and user.description != "" %}
                        <h7 class="font-weight-bold font-size-smaller">
                            User biography:<br/>
                        </h7>
                        <p class="pl-2">{{ user.description }}</p>
                    {% endif %}
                    {% if currentUser.id == user.id and currentUser.id != NULL %}
                        <button class="btn btn-outline-secondary" type="button" data-toggle="modal" data-target="#editProfile">Edit your profile</button>
                    {% endif %}
                </div>
            </div>

            <hr class="mx-4"/>

            <div class="card-body pt-0 pb-3">
                <b>Most useful reviews written by {{ user.username }}:</b>
                {% for review in user.reviews %}
                    <div class="card m-2 mt-1 mb-3">
                        <div class="card-body pb-2 pt-2">
                            <small class="float-right pt-2">
                                {% if review.rating|floatformat:"0" == "0" %}
                                    <i class="fa fa-star-o"></i>
                                    <i class="fa fa-star-o"></i>
                                    <i class="fa fa-star-o"></i>
                                    <i class="fa fa-star-o"></i>
                                    <i class="fa fa-star-o"></i>
                                {% endif %}
                                {% if review.rating|floatformat:"0" == "1" %}
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star-o"></i>
                                    <i class="fa fa-star-o"></i>
                                    <i class="fa fa-star-o"></i>
                                    <i class="fa fa-star-o"></i>
                                {% endif %}
                                {% if review.rating|floatformat:"0" == "2" %}
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star-o"></i>
                                    <i class="fa fa-star-o"></i>
                                    <i class="fa fa-star-o"></i>
                                {% endif %}
                                {% if review.rating|floatformat:"0" == "3" %}
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star-o"></i>
                                    <i class="fa fa-star-o"></i>
                                {% endif %}
                                {% if review.rating|floatformat:"0" == "4" %}
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star-o"></i>
                                {% endif %}
                                {% if review.rating|floatformat:"0" == "5" %}
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                {% endif %}
                            </small>
                            <p class="text-nowrap mb-2">
                                <b>{{ user.username }}</b> reviewed <a href="/places/{{ review.place.id }}" class="text-dark">{{ review.place.name }}</a> ({{ review.place.street }} street in {{ review.place.country }})
                            </p>
                            <div class="card p-2 pl-3 text-justify" id="reviewContent">
                                {{ review.text }}
                            </div>
                            <p class="text-nowrap m-0 pt-1 float-right" style="font-size: smaller">
                                Review written {{ review.time|slice:"5:7"}}.{{ review.time|slice:"8:10"}}.{{ review.time|slice:"0:4"}} {{ review.time|slice:"11:16"}}
                            </p>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>

        <div class="modal fade" id="editProfile">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">

                <div class="modal-header">
                  <h4 class="modal-title">Edit your profile</h4>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <div class="modal-body"><!-- uname, fname, lname, dsc, street, city, zip, country, pwd? -->
                    <form>
                        <div class="form-inline">
                            <div class="form-group mb-2 col-lg-12 mx-0 px-0">
                              <label for="Username" class="mr-2">Username: </label>
                              <input type="text" class="form-control" id="username" value="{{ user.username }}" placeholder="Enter your username" style="width: available;">
                            </div>
                        </div>

                        <div class="form-inline row">
                            <div class="form-group mb-2 col-lg-6">
                              <label for="fName" class="mr-2">First name: </label>
                              <input type="text" class="form-control" id="fName" value="{{ user.firstName }}" placeholder="Enter your first name">
                            </div>
                            <div class="form-group col-lg-6">
                              <label for="lName" class="mr-2">Last name: </label>
                              <input type="text" class="form-control" id="lName" value="{{ user.lastName }}" placeholder="Enter your last name">
                            </div>
                        </div>

                        <hr class="mb-4"/>

                        <div class="form-inline">
                            <div class="form-group mb-2 col-lg-12 px-0 mx-0">
                              <label for="street" class="mr-2">Street: </label>
                              <input type="text" class="form-control" id="street" value="{{ user.street }}" placeholder="Enter street you live on">
                            </div>
                        </div>

                        <div class="form-inline">
                            <div class="form-group mb-2 col-lg-4 px-0 mx-0">
                              <label for="city" class="mr-2">City: </label>
                              <input type="text" class="form-control" id="city" value="{{ user.city }}" placeholder="Enter your city">
                            </div>
                            <div class="form-group mb-2 col-lg-4 px-0 mx-0">
                              <label for="country" class="mr-2">Country: </label>
                              <select id="country" class="form-control">
                                <option selected>{{ user.country }}</option>
                                <option>...</option>
                              </select>
                            </div>
                            <div class="form-group mb-2 col-lg-4 px-0 mx-0">
                              <label for="zip" class="mr-2">Zip: </label>
                              <input type="text" class="form-control" id="zip" value="{{ user.zipCode }}" placeholder="Enter your zip">
                            </div>
                        </div>

                        <hr class="mb-4"/>

                        <div class="form-group">
                          <label for="description">Your biography:</label>
                          <textarea class="form-control" id="description" rows="3" placeholder="Your biography">{{ user.description }}</textarea>
                        </div>
                    </form>
                </div>

                <div class="modal-footer">
                  <button type="button" class="btn btn-success" data-dismiss="modal">Save</button>
                  <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                </div>

              </div>
            </div>
        </div>
    </div>
{% endblock %}
    <script>
        $("#writeReview").on('show.bs.collapse', function(){
            document.getElementById('buttonCollapse').innerText = "Close your review";
          });
        $("#writeReview").on('hide.bs.collapse', function(){
            document.getElementById('buttonCollapse').innerText = "Write a review!";
          });
    </script>
{% block js %}

{% endblock %}